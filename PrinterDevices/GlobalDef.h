#pragma once
#include "afxwin.h"

/* Debug Ctrl Define */
//#define DEBUG_RUN
//#define USE_ELINE_MODEL
#define USE_HIDA_MODEL
#define USE_HIDA_PLUS_MODEL
#define USE_ROCKY_DEGRADE_MODEL
#define USE_ROCKY_MODEL
#define USE_ROCKY_PLUS_MODEL
#define USE_TIANTAI_HIDA_MODEL
#define USE_TIANTAI_ROCKY_MODEL

#define DEVICE_ENUM_GUID      //通过固定GUID枚举设备

//#define ENABLE_SCAN_SERVICE

#ifdef USE_ROCKY_MODEL
//#define USE_ROCKY_MODEL_OLD
#endif

//#define DISABLE_UPDATE_APP

/* Global Data Define */
//version MajorVersion.MinorVersion.Year.Date
#define PACKAGE_VERSION                 _T("4.5.8")

#define CONNECT_TYPE_USB	            (1)
#define CONNECT_TYPE_NW                 (2)
#define PRINTER_MODEL_SFP	            (0x00)
#define PRINTER_MODEL_MFP_FLATBED       (0x01)
#define PRINTER_MODEL_MFP_ADF           (0x02)
#define CONNECT_MODEL_USB               (0x01)
#define CONNECT_MODEL_WIFI              (0x02)
#define CONNECT_MODEL_ETHERNET          (0x04)
#define CONNECT_MODEL_N                 (CONNECT_MODEL_USB | CONNECT_MODEL_ETHERNET)
#define CONNECT_MODEL_W                 (CONNECT_MODEL_USB | CONNECT_MODEL_WIFI)
#define CONNECT_MODEL_NW                (CONNECT_MODEL_USB | CONNECT_MODEL_ETHERNET | CONNECT_MODEL_WIFI)

#define TIMER_ID_BUTTON_CHANGE			(1)
#define MAX_PRINTER_NUM                 (128)
#define MAX_DLG_BUTTON_NUM              (32)

#define APP_PATH_STR                    _T("App")
#define DRIVER_DEST_PATH_STR            (CGlobalData::g_strProgramFiles + _T("\\Deli\\"))
#define DRIVER_SERIES_PATH_STR          _T("Laser Printer Series\\")
#define DRIVER_BIN_PATH_STR             _T("Bin\\")
#define DRIVER_SOURCE_PATH_STR          _T("Driver\\")
#define DRIVER_FILE_PATH_STR            _T("File\\")
#define PRINTER_DRIVER_PATH_STR         _T("Printer\\")
#define STUB_DRIVER_PATH_STR            _T("Stub")
#define SCANNER_DRIVER_NW_STR           _T("NetworkDrivers")
#define SCANNER_DRIVER_USB_STR          _T("UsbDrivers")
#define CAT_FILE_PATH_STR               _T("Cat\\")
#define CAT_WIN7_PATH_STR               _T("win7\\")
#define CAT_WIN81_PATH_STR              _T("win81\\")
#define CAT_WIN10_PATH_STR              _T("win10\\")
#define CAT_FILE_PRINT_STR              _T("deliprndrv.cat")
#define CAT_FILE_STUB_STR               _T("deliscn_stubdrv.cat")
#define CAT_FILE_SCAN_NW_STR            _T("deliscn_nw_100.cat")
#define CAT_FILE_SCAN_USB_STR           _T("deliscn_usb_100.cat")
#define VBS_FILE_PROPORT_NAME_STR       _T("prnport.vbs")
#define PRINTER_INF_FILE_NAME_STR	    _T("DELIPRNDRV.inf")
#define STUB_INF_FILE_NAME_STR	        _T("DELISCN_STUBDRV.INF")
#define SCANNER_INF_FILE_NAME_NW	    _T("DELISCN_NW.INF")
#define SCANNER_INF_FILE_NAME_USB	    _T("DELISCN_USB.INF")
#define SCANNER_INSTALL_EXE_STR         _T("DeliL1050_Setup.exe")
#define SCANNER_UNINSTALL_EXE_STR       _T("DeliL1050_UnInstall.exe")
#define SCANNER_CONFIG_FILE_NAME	    _T("DELISCN_Config.ini")
#define SCANNER_CONFIG_MAIN_FILE_NAME	_T("DELISCN_ConfigMain.ini")
#define DEVCON_EXE_PATH_STR             _T("Bin\\devcon.exe")
//#define INSTSRV_EXE_PATH_STR            _T("Bin\\instsrv.exe")
//#define SRVANY_EXE_PATH_STR             _T("Bin\\srvany.exe")
#define USBUTILA_EXE_PATH_STR           _T("Bin\\usbutila.exe")
#define SCAN_APP_EXE_PATH_STR           _T("Bin\\ScanApp.exe")
//#define USBPNP_EXE_PATH_STR             _T("Bin\\DeliUSBPnP.exe")
//#define USBALERT_EXE_PATH_STR           _T("Bin\\DeliCheckAlert.exe")
//#define SCANSERVICE_EXE_PATH_STR        _T("Bin\\DeliScanService.exe")
#define SERVICE_EXE_PATH_STR            _T("Bin\\DeliPrintService.exe")
#define DPINST_EXE_NAME_STR             _T("dpinst.exe")
#define DRIVER_INSTALL_EXE_NAME         _T("PrintDriverInstall.exe")
#define DRIVER_APP_EXE_NAME             _T("PrintDriverApp.exe")
#define DRIVER_UPDATE_EXE_NAME          _T("DeliPrintUpdate.exe")
#define USBPNP_SERVICE_NAME_STR         _T("DeliUSBPnP")
#define USBALERT_SERVICE_NAME_STR       _T("DeliUSBAlert")
#define SCAN_SERVICE_NAME_STR           _T("DeliScanService")
#define REG_RUN_NAME_STR                _T("DeliPrinterApp")

typedef enum enPrinterType
{
#ifdef USE_HIDA_MODEL
	EN_PRINTER_TYPE_L1050_START = 0,
	EN_PRINTER_TYPE_L1050D = EN_PRINTER_TYPE_L1050_START,
	EN_PRINTER_TYPE_L1050ADNW,
	EN_PRINTER_TYPE_L1050ADN,
	EN_PRINTER_TYPE_L1050ADW,
	EN_PRINTER_TYPE_L1050AD,
	EN_PRINTER_TYPE_L1050DN,
	EN_PRINTER_TYPE_L1050DW,
	EN_PRINTER_TYPE_L1050_END = EN_PRINTER_TYPE_L1050DW,

	EN_PRINTER_TYPE_L1000_START,
	EN_PRINTER_TYPE_L1000D = EN_PRINTER_TYPE_L1000_START,
	EN_PRINTER_TYPE_L1000DNW,
	EN_PRINTER_TYPE_L1000DN,
	EN_PRINTER_TYPE_L1000DW,
	EN_PRINTER_TYPE_L1000_END = EN_PRINTER_TYPE_L1000DW,
#endif

#ifdef USE_HIDA_PLUS_MODEL
	EN_PRINTER_TYPE_L1150_START,
	EN_PRINTER_TYPE_L1150ADNW = EN_PRINTER_TYPE_L1150_START,
	EN_PRINTER_TYPE_L1150ADN,
	EN_PRINTER_TYPE_L1150ADW,
	EN_PRINTER_TYPE_L1150_END = EN_PRINTER_TYPE_L1150ADW,

	EN_PRINTER_TYPE_L1100_START,
	EN_PRINTER_TYPE_L1100DNW = EN_PRINTER_TYPE_L1100_START,
	EN_PRINTER_TYPE_L1100DN,
	EN_PRINTER_TYPE_L1100DW,
	EN_PRINTER_TYPE_L1100_END = EN_PRINTER_TYPE_L1100DW,
#endif

#ifdef USE_ROCKY_DEGRADE_MODEL
	EN_PRINTER_TYPE_M2020_START,
	EN_PRINTER_TYPE_M2020W = EN_PRINTER_TYPE_M2020_START,
	EN_PRINTER_TYPE_M2020DW,
	EN_PRINTER_TYPE_M2020_END = EN_PRINTER_TYPE_M2020DW,

	EN_PRINTER_TYPE_P2020_START,
	EN_PRINTER_TYPE_P2020W = EN_PRINTER_TYPE_P2020_START,
	EN_PRINTER_TYPE_P2020DW,
	EN_PRINTER_TYPE_P2020_END = EN_PRINTER_TYPE_P2020DW,
#endif

#ifdef USE_ROCKY_MODEL
	EN_PRINTER_TYPE_L2050_START,
	EN_PRINTER_TYPE_L2050DNW = EN_PRINTER_TYPE_L2050_START,
	EN_PRINTER_TYPE_L2050DN,
	EN_PRINTER_TYPE_L2050D,
	EN_PRINTER_TYPE_L2050NW,
	EN_PRINTER_TYPE_L2050N,
	EN_PRINTER_TYPE_L2050,
	EN_PRINTER_TYPE_L2050W,
	EN_PRINTER_TYPE_L2050DW,
	EN_PRINTER_TYPE_L2050_END = EN_PRINTER_TYPE_L2050DW,

	EN_PRINTER_TYPE_L2000_START,
	EN_PRINTER_TYPE_L2000DNW = EN_PRINTER_TYPE_L2000_START,
	EN_PRINTER_TYPE_L2000DN,
	EN_PRINTER_TYPE_L2000D,
	EN_PRINTER_TYPE_L2000NW,
	EN_PRINTER_TYPE_L2000N,
	EN_PRINTER_TYPE_L2000,
	EN_PRINTER_TYPE_L2000W,
	EN_PRINTER_TYPE_L2000DW,
	EN_PRINTER_TYPE_L2000_END = EN_PRINTER_TYPE_L2000DW,
#endif

#ifdef USE_ROCKY_PLUS_MODEL
	EN_PRINTER_TYPE_L2150_START,
	EN_PRINTER_TYPE_L2150DNW = EN_PRINTER_TYPE_L2150_START,
	EN_PRINTER_TYPE_L2150DN,
	EN_PRINTER_TYPE_L2150D,
	EN_PRINTER_TYPE_L2150NW,
	EN_PRINTER_TYPE_L2150N,
	EN_PRINTER_TYPE_L2150,
	EN_PRINTER_TYPE_L2150W,
	EN_PRINTER_TYPE_L2150DW,
	EN_PRINTER_TYPE_L2150_END = EN_PRINTER_TYPE_L2150DW,

	EN_PRINTER_TYPE_L2100_START,
	EN_PRINTER_TYPE_L2100DNW = EN_PRINTER_TYPE_L2100_START,
	EN_PRINTER_TYPE_L2100DN,
	EN_PRINTER_TYPE_L2100D,
	EN_PRINTER_TYPE_L2100NW,
	EN_PRINTER_TYPE_L2100N,
	EN_PRINTER_TYPE_L2100,
	EN_PRINTER_TYPE_L2100W,
	EN_PRINTER_TYPE_L2100DW,
	EN_PRINTER_TYPE_L2100_END = EN_PRINTER_TYPE_L2100DW,
#endif

#ifdef USE_TIANTAI_HIDA_MODEL
	EN_PRINTER_TYPE_DM28_START,
	EN_PRINTER_TYPE_DM28ADN = EN_PRINTER_TYPE_DM28_START,
	EN_PRINTER_TYPE_DM28AD,
	EN_PRINTER_TYPE_DM28D,
	EN_PRINTER_TYPE_DM28_END = EN_PRINTER_TYPE_DM28D,

	EN_PRINTER_TYPE_DP28_START,
	EN_PRINTER_TYPE_DP28DN = EN_PRINTER_TYPE_DP28_START,
	EN_PRINTER_TYPE_DP28D,
	EN_PRINTER_TYPE_DP28_END = EN_PRINTER_TYPE_DP28D,


	EN_PRINTER_TYPE_ZYP31_START,
	EN_PRINTER_TYPE_ZYP3110D = EN_PRINTER_TYPE_ZYP31_START,
	EN_PRINTER_TYPE_ZYP31_END = EN_PRINTER_TYPE_ZYP3110D,

	EN_PRINTER_TYPE_ZYM61_START,
	EN_PRINTER_TYPE_ZYM6130ADN = EN_PRINTER_TYPE_ZYM61_START,
	EN_PRINTER_TYPE_ZYM6120AD,
	EN_PRINTER_TYPE_ZYM6110D,
	EN_PRINTER_TYPE_ZYM61_END = EN_PRINTER_TYPE_ZYM6110D,

#endif

#ifdef USE_TIANTAI_ROCKY_MODEL
	EN_PRINTER_TYPE_DM25_START,
	EN_PRINTER_TYPE_DM25DN = EN_PRINTER_TYPE_DM25_START,
	EN_PRINTER_TYPE_DM25N,
	EN_PRINTER_TYPE_DM25,
	EN_PRINTER_TYPE_DM25_END = EN_PRINTER_TYPE_DM25,

	EN_PRINTER_TYPE_DP25_START,
	EN_PRINTER_TYPE_DP25DN = EN_PRINTER_TYPE_DP25_START,
	EN_PRINTER_TYPE_DP25N,
	EN_PRINTER_TYPE_DP25,
	EN_PRINTER_TYPE_DP25_END = EN_PRINTER_TYPE_DP25,

	EN_PRINTER_TYPE_ZYP30_START,
	EN_PRINTER_TYPE_ZYP3020DN = EN_PRINTER_TYPE_ZYP30_START,
	EN_PRINTER_TYPE_ZYP3010N,
	EN_PRINTER_TYPE_ZYP3000,
	EN_PRINTER_TYPE_ZYP30_END = EN_PRINTER_TYPE_ZYP3000,

	EN_PRINTER_TYPE_ZYM60_START,
	EN_PRINTER_TYPE_ZYM6020DN = EN_PRINTER_TYPE_ZYM60_START,
	EN_PRINTER_TYPE_ZYM6010N,
	EN_PRINTER_TYPE_ZYM6000,
	EN_PRINTER_TYPE_ZYM60_END = EN_PRINTER_TYPE_ZYM6000,

#endif

#ifdef USE_ELINE_MODEL
	EN_PRINTER_TYPE_EM2501,
	EN_PRINTER_TYPE_ES1501,
#endif

	EN_PRINTER_TYPE_MAX
}EnPrinterType;

typedef enum enOSPlatform
{
	EN_OS_PLATFORM_UNKNOWN   = 0,

	EN_OS_PLATFORM_XP_X86    = 0x0001,
	EN_OS_PLATFORM_VISTA_X86 = 0x0002,
	EN_OS_PLATFORM_7_X86     = 0x0004,
	EN_OS_PLATFORM_8_X86     = 0x0008,
	EN_OS_PLATFORM_8_1_X86   = 0x0010,
	EN_OS_PLATFORM_10_X86    = 0x0020,
	EN_OS_PLATFORM_WIN_X86   = 0x00FF,

	EN_OS_PLATFORM_XP_X64    = 0x0100, //Windows Server 2003 R2 / Windows Server 2003 / Windows Home Server / WinXP x64
	EN_OS_PLATFORM_VISTA_X64 = 0x0200, //Vista / Windows Server 2008
	EN_OS_PLATFORM_7_X64     = 0x0400, //Win7 / Windows Server 2008 R2
	EN_OS_PLATFORM_8_X64     = 0x0800, //Win8 / Windows Server 2012
	EN_OS_PLATFORM_8_1_X64   = 0x1000, //Win8.1 / Windows Server 2012 R2
	EN_OS_PLATFORM_10_X64    = 0x2000, //Win10 / Windows Server 2016
	EN_OS_PLATFORM_WIN_X64   = 0xFF00,

	EN_OS_PLATFORM_MAX       = 0xFFFF
}EnOSPlatform;

typedef struct stPrinterInfo
{
	EnPrinterType enType;
	DWORD iNo;
	DWORD iConnectType;
	CString strName;
	CString strPort;
	CString strSubKeyPath;
}StPrinterInfo;

typedef struct stModelTypeTag
{
	EnPrinterType enType;	
	int iPrinterModel;
	int iConnectModel;
	CString strModel;
	//CString strInfName;
	//CString strScannerInstall;
	//CString strScannerUninstall;
	int iVid;
	int iPid;
	CString strPrinterHDID;
	CString strScannerHDID;
}StModelTypeTag;

const StModelTypeTag c_stModelTypeTag[] =
{
#ifdef USE_HIDA_MODEL
	{ EN_PRINTER_TYPE_L1050D,    PRINTER_MODEL_MFP_FLATBED, CONNECT_MODEL_USB, _T("Deli M2500D"),\
	  0x300E, 0x1001, _T("USBPRINT\\DeliM2500DC026"),        _T("USB\\VID_300E&PID_1001&REV_0000&MI_00")},
	{ EN_PRINTER_TYPE_L1050ADNW, PRINTER_MODEL_MFP_ADF,     CONNECT_MODEL_NW,  _T("Deli M2500ADNW"),\
	  0x300E, 0x1002, _T("USBPRINT\\DeliM2500ADNW4C85"),     _T("USB\\VID_300E&PID_1002&REV_0000&MI_00") },
	{ EN_PRINTER_TYPE_L1050ADN,  PRINTER_MODEL_MFP_ADF,     CONNECT_MODEL_N,   _T("Deli M2500ADN"),\
	  0x300E, 0x1003, _T("USBPRINT\\DeliM2500ADN05B9"),      _T("USB\\VID_300E&PID_1003&REV_0000&MI_00") },
	{ EN_PRINTER_TYPE_L1050ADW,  PRINTER_MODEL_MFP_ADF,     CONNECT_MODEL_W,   _T("Deli M2500ADW"),\
	  0x300E, 0x1004, _T("USBPRINT\\DeliM2500ADWCF78"),      _T("USB\\VID_300E&PID_1004&REV_0000&MI_00") },
	{ EN_PRINTER_TYPE_L1050AD,   PRINTER_MODEL_MFP_ADF,     CONNECT_MODEL_USB, _T("Deli M2500AD"),\
	  0x300E, 0x1005, _T("USBPRINT\\DeliM2500ADB942"),       _T("USB\\VID_300E&PID_1005&REV_0000&MI_00") },
	{ EN_PRINTER_TYPE_L1050DN,   PRINTER_MODEL_MFP_FLATBED, CONNECT_MODEL_N,   _T("Deli M2500DN"),\
	  0x300E, 0x100B, _T("USBPRINT\\DeliM2500DNEEC1"),       _T("USB\\VID_300E&PID_100B&REV_0000&MI_00") },
	{ EN_PRINTER_TYPE_L1050DW,   PRINTER_MODEL_MFP_FLATBED, CONNECT_MODEL_W,   _T("Deli M2500DW"),\
	  0x300E, 0x100C, _T("USBPRINT\\DeliM2500DW2400"),       _T("USB\\VID_300E&PID_100C&REV_0000&MI_00") },

	{ EN_PRINTER_TYPE_L1000D,    PRINTER_MODEL_SFP,         CONNECT_MODEL_USB, _T("Deli P2500D"),\
	  0x300E, 0x1006, _T("USBPRINT\\DeliP2500D4C07"),        _T("") },
	{ EN_PRINTER_TYPE_L1000DNW,  PRINTER_MODEL_SFP,         CONNECT_MODEL_NW,  _T("Deli P2500DNW"),\
	  0x300E, 0x1007, _T("USBPRINT\\DeliP2500DNW9B77"),      _T("") },
	{ EN_PRINTER_TYPE_L1000DN,   PRINTER_MODEL_SFP,         CONNECT_MODEL_N,   _T("Deli P2500DN"),\
	  0x300E, 0x100D, _T("USBPRINT\\DeliP2500DNF68D"),       _T("") },
	{ EN_PRINTER_TYPE_L1000DW,   PRINTER_MODEL_SFP,         CONNECT_MODEL_W,   _T("Deli P2500DW"),\
	  0x300E, 0x100E, _T("USBPRINT\\DeliP2500DW3C4C"),       _T("") },
#endif
#ifdef USE_HIDA_PLUS_MODEL
	{ EN_PRINTER_TYPE_L1150ADNW, PRINTER_MODEL_MFP_ADF,     CONNECT_MODEL_NW,  _T("Deli M2505ADNW"),\
	  0x300E, 0x1024, _T("USBPRINT\\DeliM2505ADNW4C49"),     _T("USB\\VID_300E&PID_1024&REV_0000&MI_00") },
	{ EN_PRINTER_TYPE_L1150ADN,  PRINTER_MODEL_MFP_ADF,     CONNECT_MODEL_N,   _T("Deli M2505ADN"),\
	  0x300E, 0x1026, _T("USBPRINT\\DeliM2505ADNC9B9"),      _T("USB\\VID_300E&PID_1026&REV_0000&MI_00") },
	{ EN_PRINTER_TYPE_L1150ADW,  PRINTER_MODEL_MFP_ADF,     CONNECT_MODEL_W,   _T("Deli M2505ADW"),\
	  0x300E, 0x1025, _T("USBPRINT\\DeliM2505ADW0378"),      _T("USB\\VID_300E&PID_1025&REV_0000&MI_00") },
	{ EN_PRINTER_TYPE_L1100DNW,  PRINTER_MODEL_SFP,         CONNECT_MODEL_NW,  _T("Deli P2505DNW"),\
	  0x300E, 0x1021, _T("USBPRINT\\DeliP2505DNW5777"),      _T("") },
	{ EN_PRINTER_TYPE_L1100DN,   PRINTER_MODEL_SFP,         CONNECT_MODEL_N,   _T("Deli P2505DN"),\
	  0x300E, 0x1023, _T("USBPRINT\\DeliP2505DNF79D"),       _T("") },
	{ EN_PRINTER_TYPE_L1100DW,   PRINTER_MODEL_SFP,         CONNECT_MODEL_W,   _T("Deli P2505DW"),\
	  0x300E, 0x1022, _T("USBPRINT\\DeliP2505DW3D5C"),       _T("") },
#endif
#ifdef USE_ROCKY_DEGRADE_MODEL
	{ EN_PRINTER_TYPE_M2020W,   PRINTER_MODEL_MFP_ADF,      CONNECT_MODEL_W,   _T("Deli M2020W"),\
	  0x300E, 0x1082, _T("USBPRINT\\DeliM2020WC045"),       _T("USB\\VID_300E&PID_1082&REV_0000&MI_00") },
	{ EN_PRINTER_TYPE_M2020DW,   PRINTER_MODEL_MFP_ADF,     CONNECT_MODEL_W,   _T("Deli M2020DW"),\
	  0x300E, 0x1084, _T("USBPRINT\\DeliM2020DW3D4D"),      _T("USB\\VID_300E&PID_1084&REV_0000&MI_00") },
	{ EN_PRINTER_TYPE_P2020W,   PRINTER_MODEL_SFP,          CONNECT_MODEL_W,   _T("Deli P2020W"),\
	  0x300E, 0x1081, _T("USBPRINT\\DeliP2020W8DE5"),       _T("") },
	{ EN_PRINTER_TYPE_P2020DW,   PRINTER_MODEL_SFP,         CONNECT_MODEL_W,   _T("Deli P2020DW"),\
	  0x300E, 0x1083, _T("USBPRINT\\DeliP2020DW4702"),      _T("") },
#endif
#ifdef USE_ROCKY_MODEL
	{ EN_PRINTER_TYPE_L2050DNW,  PRINTER_MODEL_MFP_FLATBED, CONNECT_MODEL_NW,  _T("Deli M2000DNW"),\
	  0x300E, 0x1046, _T("USBPRINT\\DeliM2000DNWFBCF"),      _T("USB\\VID_300E&PID_1046&REV_0000&MI_00") },
	{ EN_PRINTER_TYPE_L2050DN,   PRINTER_MODEL_MFP_FLATBED, CONNECT_MODEL_N,   _T("Deli M2000DN"),\
	  0x300E, 0x1047, _T("USBPRINT\\DeliM2000DN8E0C"),       _T("USB\\VID_300E&PID_1047&REV_0000&MI_00") },
	{ EN_PRINTER_TYPE_L2050D,    PRINTER_MODEL_MFP_FLATBED, CONNECT_MODEL_USB, _T("Deli M2000D"),\
	  0x300E, 0x1048, _T("USBPRINT\\DeliM2000DCDA7"),        _T("USB\\VID_300E&PID_1048&REV_0000&MI_00") },
#ifdef USE_ROCKY_MODEL_OLD
	{ EN_PRINTER_TYPE_L2050NW,   PRINTER_MODEL_MFP_FLATBED, CONNECT_MODEL_NW,  _T("Deli L2050NW"),\
	  0x300E, 0x1016, _T("USBPRINT\\DeliDeli_L2050NWA4C8"),  _T("USB\\VID_300E&PID_1016&REV_0000&MI_00") },
#else
	{ EN_PRINTER_TYPE_L2050NW,   PRINTER_MODEL_MFP_FLATBED, CONNECT_MODEL_NW,  _T("Deli M2000NW"),\
	  0x300E, 0x1016, _T("USBPRINT\\DeliM2000NWE4CB"),       _T("USB\\VID_300E&PID_1016&REV_0000&MI_00") },
#endif
	{ EN_PRINTER_TYPE_L2050N,    PRINTER_MODEL_MFP_FLATBED, CONNECT_MODEL_N,   _T("Deli M2000N"),\
	  0x300E, 0x1049, _T("USBPRINT\\DeliM2000NCA27"),        _T("USB\\VID_300E&PID_1049&REV_0000&MI_00") },
	{ EN_PRINTER_TYPE_L2050,     PRINTER_MODEL_MFP_FLATBED, CONNECT_MODEL_USB, _T("Deli M2000"),\
	  0x300E, 0x104A, _T("USBPRINT\\DeliM2000E657"),         _T("USB\\VID_300E&PID_104A&REV_0000&MI_00") },
	{ EN_PRINTER_TYPE_L2050W,    PRINTER_MODEL_MFP_FLATBED, CONNECT_MODEL_W,   _T("Deli M2000W"),\
	  0x300E, 0x1059, _T("USBPRINT\\DeliM2000W00E6"),        _T("USB\\VID_300E&PID_1059&REV_0000&MI_00") },
	{ EN_PRINTER_TYPE_L2050DW,   PRINTER_MODEL_MFP_FLATBED, CONNECT_MODEL_W,   _T("Deli M2000DW"),\
	  0x300E, 0x105F, _T("USBPRINT\\DeliM2000DW46CD"),       _T("USB\\VID_300E&PID_105F&REV_0000&MI_00") },

	{ EN_PRINTER_TYPE_L2000DNW,  PRINTER_MODEL_SFP,         CONNECT_MODEL_NW,  _T("Deli P2000DNW"),\
	  0x300E, 0x1041, _T("USBPRINT\\DeliP2000DNW0FF6"),      _T("") },
	{ EN_PRINTER_TYPE_L2000DN,   PRINTER_MODEL_SFP,         CONNECT_MODEL_N,   _T("Deli P2000DN"),\
	  0x300E, 0x1042, _T("USBPRINT\\DeliP2000DNF643"),       _T("") },
	{ EN_PRINTER_TYPE_L2000D,    PRINTER_MODEL_SFP,         CONNECT_MODEL_USB, _T("Deli P2000D"),\
	  0x300E, 0x1043, _T("USBPRINT\\DeliP2000D8207"),        _T("") },
#ifdef USE_ROCKY_MODEL_OLD
	{ EN_PRINTER_TYPE_L2000NW,   PRINTER_MODEL_SFP,         CONNECT_MODEL_NW,  _T("Deli L2000NW"),\
	  0x300E, 0x1013, _T("USBPRINT\\DeliDeli_L2000NW68C8"),   _T("") },
#else
	{ EN_PRINTER_TYPE_L2000NW,   PRINTER_MODEL_SFP,         CONNECT_MODEL_NW,  _T("Deli P2000NW"),\
	  0x300E, 0x1013, _T("USBPRINT\\DeliP2000NW9C84"),  _T("") },
#endif
	{ EN_PRINTER_TYPE_L2000N,    PRINTER_MODEL_SFP,         CONNECT_MODEL_N,   _T("Deli P2000N"),\
	  0x300E, 0x1044, _T("USBPRINT\\DeliP2000N8587"),        _T("") },
	{ EN_PRINTER_TYPE_L2000,     PRINTER_MODEL_SFP,         CONNECT_MODEL_USB, _T("Deli P2000"),\
	  0x300E, 0x1045, _T("USBPRINT\\DeliP200086BA"),         _T("") },
	{ EN_PRINTER_TYPE_L2000W,    PRINTER_MODEL_SFP,         CONNECT_MODEL_W,   _T("Deli P2000W"),\
	  0x300E, 0x1058, _T("USBPRINT\\DeliP2000W4D46"),        _T("") },
	{ EN_PRINTER_TYPE_L2000DW,   PRINTER_MODEL_SFP,         CONNECT_MODEL_W,  _T("Deli P2000DW"),\
	  0x300E, 0x105E, _T("USBPRINT\\DeliP2000DW3C82"),        _T("") },

#endif
#ifdef USE_ROCKY_PLUS_MODEL
	{ EN_PRINTER_TYPE_L2150DNW,  PRINTER_MODEL_MFP_FLATBED, CONNECT_MODEL_NW,  _T("Deli M2005DNW"),\
	  0x300E, 0x1053, _T("USBPRINT\\DeliM2005DNW37CF"),      _T("USB\\VID_300E&PID_1053&REV_0000&MI_00") },
	{ EN_PRINTER_TYPE_L2150DN,   PRINTER_MODEL_MFP_FLATBED, CONNECT_MODEL_N,   _T("Deli M2005DN"),\
	  0x300E, 0x1054, _T("USBPRINT\\DeliM2005DN8F1C"),       _T("USB\\VID_300E&PID_1054&REV_0000&MI_00") },
	{ EN_PRINTER_TYPE_L2150D,    PRINTER_MODEL_MFP_FLATBED, CONNECT_MODEL_USB, _T("Deli M2005D"),\
	  0x300E, 0x1055, _T("USBPRINT\\DeliM2005D9DA4"),        _T("USB\\VID_300E&PID_1055&REV_0000&MI_00") },
	{ EN_PRINTER_TYPE_L2150NW,   PRINTER_MODEL_MFP_FLATBED, CONNECT_MODEL_NW,  _T("Deli M2005NW"),\
	  0x300E, 0x1052, _T("USBPRINT\\DeliM2005NWE5DB"),       _T("USB\\VID_300E&PID_1052&REV_0000&MI_00") },
	{ EN_PRINTER_TYPE_L2150N,    PRINTER_MODEL_MFP_FLATBED, CONNECT_MODEL_N,   _T("Deli M2005N"),\
	  0x300E, 0x1056, _T("USBPRINT\\DeliM2005N9A24"),        _T("USB\\VID_300E&PID_1056&REV_0000&MI_00") },
	{ EN_PRINTER_TYPE_L2150,     PRINTER_MODEL_MFP_FLATBED, CONNECT_MODEL_USB, _T("Deli M2005"),\
	  0x300E, 0x1057, _T("USBPRINT\\DeliM2005E597"),         _T("USB\\VID_300E&PID_1057&REV_0000&MI_00") },
	{ EN_PRINTER_TYPE_L2150W,    PRINTER_MODEL_MFP_FLATBED, CONNECT_MODEL_USB, _T("Deli M2005W"),\
	  0x300E, 0x105C, _T(" USBPRINT\\DeliM2005W50E5"),       _T("USB\\VID_300E&PID_105C&REV_0000&MI_00") },
	{ EN_PRINTER_TYPE_L2150DW,   PRINTER_MODEL_MFP_FLATBED, CONNECT_MODEL_USB, _T("Deli M2005DW"),\
	  0x300E, 0x105D, _T("USBPRINT\\DeliM2005DW47DD"),       _T("USB\\VID_300E&PID_105D&REV_0000&MI_00") },

	{ EN_PRINTER_TYPE_L2100DNW,  PRINTER_MODEL_SFP,         CONNECT_MODEL_NW,  _T("Deli P2005DNW"),\
	  0x300E, 0x104C, _T("USBPRINT\\DeliP2005DNW0277"),      _T("") },
	{ EN_PRINTER_TYPE_L2100DN,   PRINTER_MODEL_SFP,         CONNECT_MODEL_N,   _T("Deli P2005DN"),\
	  0x300E, 0x104D, _T("USBPRINT\\DeliP2005DNF751"),       _T("") },
	{ EN_PRINTER_TYPE_L2100D,    PRINTER_MODEL_SFP,         CONNECT_MODEL_USB, _T("Deli P2005D"),\
	  0x300E, 0x104E, _T("USBPRINT\\DeliP2005DD004"),        _T("") },
	{ EN_PRINTER_TYPE_L2100NW,   PRINTER_MODEL_SFP,         CONNECT_MODEL_NW,  _T("Deli P2005NW"),\
	  0x300E, 0x104B, _T("USBPRINT\\DeliP2005NW9D96"),       _T("") },
	{ EN_PRINTER_TYPE_L2100N,    PRINTER_MODEL_SFP,         CONNECT_MODEL_N,   _T("Deli P2005N"),\
	  0x300E, 0x104F, _T("USBPRINT\\DeliP2005ND784"),        _T("") },
	{ EN_PRINTER_TYPE_L2100,     PRINTER_MODEL_SFP,         CONNECT_MODEL_USB, _T("Deli P2005"),\
	  0x300E, 0x1051, _T("USBPRINT\\DeliP2005857A"),         _T("") },
	{ EN_PRINTER_TYPE_L2100W,    PRINTER_MODEL_SFP,         CONNECT_MODEL_W, _T("Deli P2005W"),\
	  0x300E, 0x105A, _T("USBPRINT\\DeliP2005W1D45"),        _T("") },
	{ EN_PRINTER_TYPE_L2100DW,   PRINTER_MODEL_SFP,         CONNECT_MODEL_W, _T("Deli P2005DW"),\
	  0x300E, 0x105B, _T("USBPRINT\\DeliP2005DW3D90"),       _T("") },
#endif
#ifdef USE_TIANTAI_HIDA_MODEL
	{ EN_PRINTER_TYPE_DM28ADN,   PRINTER_MODEL_MFP_ADF,     CONNECT_MODEL_N,   _T("Deli DM28ADN"),\
	  0x300E, 0x1065, _T("USBPRINT\\DeliDM28ADN40B4"),       _T("USB\\VID_300E&PID_1065&REV_0000&MI_00") },
	{ EN_PRINTER_TYPE_DM28AD,    PRINTER_MODEL_MFP_ADF,     CONNECT_MODEL_USB, _T("Deli DM28AD"),\
	  0x300E, 0x1064, _T("USBPRINT\\DeliDM28AD74B7"),        _T("USB\\VID_300E&PID_1064&REV_0000&MI_00") },
	{ EN_PRINTER_TYPE_DM28D,     PRINTER_MODEL_MFP_FLATBED, CONNECT_MODEL_USB, _T("Deli DM28D"),\
	  0x300E, 0x1063, _T("USBPRINT\\DeliDM28D7435"),         _T("USB\\VID_300E&PID_1063&REV_0000&MI_00") },

	{ EN_PRINTER_TYPE_DP28DN,    PRINTER_MODEL_SFP,         CONNECT_MODEL_N,   _T("Deli DP28DN"),\
	  0x300E, 0x1062, _T("USBPRINT\\DeliDP28DN21D8"),        _T("") },
	{ EN_PRINTER_TYPE_DP28D,     PRINTER_MODEL_SFP,         CONNECT_MODEL_USB, _T("Deli DP28D"),\
	  0x300E, 0x1061, _T("USBPRINT\\DeliDP28D1833"),         _T("") },

	{ EN_PRINTER_TYPE_ZYP3110D,  PRINTER_MODEL_SFP,       CONNECT_MODEL_USB,   _T("Deli ZYP3110D"),\
	  0x300E, 0x10A1, _T("USBPRINT\\DeliZYP3110DFC11"),       _T("") },

	{ EN_PRINTER_TYPE_ZYM6130ADN, PRINTER_MODEL_MFP_FLATBED, CONNECT_MODEL_N, _T("Deli ZYM6130ADN"),\
	  0x300E, 0x10A2, _T("USBPRINT\\DeliZYM6130ADN7141"),    _T("USB\\VID_300E&PID_10A2&REV_0000&MI_00") },
	{ EN_PRINTER_TYPE_ZYM6120AD,  PRINTER_MODEL_MFP_FLATBED, CONNECT_MODEL_USB, _T("Deli ZYM6120AD"),\
	  0x300E, 0x10A3, _T("USBPRINT\\DeliZYM6120AD7FF2"),      _T("USB\\VID_300E&PID_10A3&REV_0000&MI_00") },
	{ EN_PRINTER_TYPE_ZYM6110D,   PRINTER_MODEL_MFP_FLATBED, CONNECT_MODEL_USB,  _T("Deli ZYM6110D"),\
	  0x300E, 0x10A4, _T("USBPRINT\\DeliZYM6110D71DE"),         _T("USB\\VID_300E&PID_10A4&REV_0000&MI_00") },
#endif
#ifdef USE_TIANTAI_ROCKY_MODEL
	{ EN_PRINTER_TYPE_DM25DN,    PRINTER_MODEL_MFP_FLATBED, CONNECT_MODEL_N,   _T("Deli DM25DN"),\
	  0x300E, 0x106B, _T("USBPRINT\\DeliDM25DNE0A5"),        _T("USB\\VID_300E&PID_106B&REV_0000&MI_00") },
	{ EN_PRINTER_TYPE_DM25N,     PRINTER_MODEL_MFP_FLATBED, CONNECT_MODEL_USB, _T("Deli DM25N"),\
	  0x300E, 0x1069, _T("USBPRINT\\DeliDM25NE3B1"),         _T("USB\\VID_300E&PID_1069&REV_0000&MI_00") },
	{ EN_PRINTER_TYPE_DM25,      PRINTER_MODEL_MFP_FLATBED, CONNECT_MODEL_USB, _T("Deli DM25"),\
	  0x300E, 0x1068, _T("USBPRINT\\DeliDM253034"),          _T("USB\\VID_300E&PID_1068&REV_0000&MI_00") },

	{ EN_PRINTER_TYPE_DP25DN,    PRINTER_MODEL_SFP,         CONNECT_MODEL_N,   _T("Deli DP25DN"),\
	  0x300E, 0x106A, _T("USBPRINT\\DeliDP25N8FB7"),        _T("") },
	{ EN_PRINTER_TYPE_DP25N,     PRINTER_MODEL_SFP,         CONNECT_MODEL_USB, _T("Deli DP25N"),\
	  0x300E, 0x1067, _T("USBPRINT\\DeliDP25N8FB7"),         _T("") },
	{ EN_PRINTER_TYPE_DP25,      PRINTER_MODEL_SFP,         CONNECT_MODEL_USB, _T("Deli DP25"),\
	  0x300E, 0x1066, _T("USBPRINT\\DeliDP2536A4"),          _T("") },

	{ EN_PRINTER_TYPE_ZYP3020DN,  PRINTER_MODEL_SFP,       CONNECT_MODEL_N,   _T("Deli ZYP3020DN"),\
	  0x300E, 0x10A5, _T("USBPRINT\\DeliZYP3020DNBC81"),         _T("") },
	{ EN_PRINTER_TYPE_ZYP3010N,  PRINTER_MODEL_SFP,        CONNECT_MODEL_N,   _T("Deli ZYP3010N"),\
	  0x300E, 0x10A6, _T("USBPRINT\\DeliZYP3010N0790"),          _T("") }, 
	{ EN_PRINTER_TYPE_ZYP3000,  PRINTER_MODEL_SFP,         CONNECT_MODEL_USB, _T("Deli ZYP3000"),\
	  0x300E, 0x10A7, _T("USBPRINT\\DeliZYP30008245"),          _T("") },

	{ EN_PRINTER_TYPE_ZYM6020DN, PRINTER_MODEL_MFP_FLATBED, CONNECT_MODEL_N,  _T("Deli ZYM6020DN"),\
	  0x300E, 0x10A8, _T("USBPRINT\\DeliZYM6020DNE84C"),       _T("USB\\VID_300E&PID_10A8&REV_0000&MI_00") },
	{ EN_PRINTER_TYPE_ZYM6010N,  PRINTER_MODEL_MFP_FLATBED, CONNECT_MODEL_N,  _T("Deli ZYM6010N"),\
	  0x300E, 0x10A9, _T("USBPRINT\\DeliZYM6010N8A5F"),        _T("USB\\VID_300E&PID_10A9&REV_0000&MI_00") },
	{ EN_PRINTER_TYPE_ZYM6000,   PRINTER_MODEL_MFP_FLATBED, CONNECT_MODEL_USB,_T("Deli ZYM6000"),\
	  0x300E, 0x10AA, _T("USBPRINT\\DeliZYM60004EA9"),         _T("USB\\VID_300E&PID_10AA&REV_0000&MI_00") },
#endif
#ifdef USE_ELINE_MODEL
	{ EN_PRINTER_TYPE_EM2501,    PRINTER_MODEL_MFP_ADF, CONNECT_MODEL_NW,  _T("Eline EM2501"),\
	  0x2B85, 0x05DC, _T("USBPRINT\\ElineEline_EM250130B1"),  _T("USB\\Vid_2B85&Pid_09C4&MI_00") },
	{ EN_PRINTER_TYPE_ES1501,    PRINTER_MODEL_SFP, CONNECT_MODEL_NW,  _T("Eline ES1501"),\
	  0x2B85, 0x09C4, _T("USBPRINT\\ElineEline_ES15017739"),  _T("") },
#endif
};

const DWORD c_dwWifiThreadID = WM_USER + 101;

class CGlobalData
{
public:
	static CRect g_rectDialog;
	static float g_fDlgWidthScale;
	static float g_fDlgHeightScale;

	static int g_iLanguageType;
	static EnOSPlatform g_enOSPlatform;
	static CString g_strCurrentExeDir;
	static CString g_strProgramFiles;
	static CString g_strSystemDisk;
	static HWND g_hwndParentDlg;
	static CList<HWND, HWND> g_listHwndDlg;
};